<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3DOPE - 3D РјРѕРґРµР»РёСЂРѕРІР°РЅРёРµ Рё РїРµС‡Р°С‚СЊ</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root { --green: #00AE42; --card-width: 900px; }

    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #e8ecef 0%, #d5e0e8 30%, #c3d4e0 60%, #b8c8d8 100%);
      color: #333;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .nav-glass {
      position: fixed;
      top: 15px;
      left: 50%;
      transform: translateX(-50%);
      width: var(--card-width);
      height: 70px;
      background: rgba(255, 255, 255, 0.45);
      backdrop-filter: blur(30px);
      -webkit-backdrop-filter: blur(30px);
      border: 1px solid rgba(255, 255, 255, 0.4);
      border-radius: 40px;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 20px;
    }

    .nav-glass nav ul {
      display: flex;
      list-style: none;
      gap: 0.5rem;
      margin: 0;
      padding: 0;
      flex-wrap: nowrap;
      width: 100%;
      justify-content: center;
    }

    .nav-glass nav a {
      color: var(--green);
      text-decoration: none;
      padding: 0.6rem 1rem;
      border-radius: 25px;
      font-weight: bold;
      font-size: 0.85rem;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid transparent;
      background: rgba(255,255,255,0.92);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      white-space: nowrap;
      text-align: center;
      flex: 1;
      max-width: 130px;
    }

    .nav-glass nav a:hover {
      background: rgba(255,255,255,1);
      border-color: var(--green);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,174,66,0.3);
    }

    section {
      min-height: 70vh;
      padding: 120px 20px 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .card {
      background: rgba(255, 255, 255, 0.92);
      padding: 2.5rem 2rem;
      border-radius: 40px;
      width: var(--card-width);
      max-width: 90vw;
      text-align: center;
      box-shadow: 0 15px 50px rgba(0,0,0,0.12);
      border: 1px solid rgba(0,174,66,0.25);
      transition: all 0.4s ease;
    }

    .card:hover { transform: translateY(-8px); box-shadow: 0 25px 70px rgba(0,0,0,0.18); }

    .card h1 {
      font-size: clamp(3rem, 8vw, 5rem);
      background: linear-gradient(135deg, var(--green), #00D45E);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1rem;
      font-weight: 800;
    }

    .card h2 {
      font-size: clamp(1.8rem, 5vw, 3rem);
      color: var(--green);
      margin-bottom: 1rem;
      font-weight: 700;
    }

    html { scroll-behavior: smooth; }

    .content-grid, .process-container, .advantages-grid { margin: 2rem auto; max-width: 900px; }

    .content-item, .process-step, .advantage-item {
      background: rgba(255, 255, 255, 0.9);
      border: 3px solid transparent;
      background-image:
        linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9)),
        linear-gradient(90deg, var(--green), #00D45E);
      border-radius: 25px;
      padding: 1.8rem;
      margin-bottom: 1.5rem;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0,0,0,0.08);
      background-clip: padding-box, border-box;
      text-align: left;
    }

    .content-item:hover, .process-step:hover, .advantage-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 45px rgba(0,174,66,0.2);
    }

    .service-price {
      font-size: 2.2rem;
      font-weight: bold;
      color: var(--green);
      margin-bottom: 0.8rem;
      display: block;
      text-align: left;
    }

    .service-title { font-size: 1.4rem; font-weight: 700; color: #333; margin-bottom: 1rem; text-align: left; }
    .service-desc { font-size: 1.05rem; color: #555; line-height: 1.6; text-align: left; }

    .advantages-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.2rem; }
    .advantage-item {
      display: flex; flex-direction: column; align-items: center; text-align: center;
      height: 220px; padding: 1.5rem 1rem; margin-bottom: 0;
    }
    .advantage-icon {
      width: 60px; height: 60px;
      background: linear-gradient(135deg, var(--green), #00D45E);
      color: white; border-radius: 15px;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.6rem; margin-bottom: 1rem;
      box-shadow: 0 6px 20px rgba(0,174,66,0.4);
      border: 3px solid rgba(255,255,255,0.3);
    }
    .advantage-title { color: var(--green); font-size: 1.2rem; margin-bottom: 0.5rem; font-weight: 700; line-height: 1.3; }
    .advantage-desc { color: #555; font-size: 0.95rem; line-height: 1.4; flex-grow: 1; display: flex; align-items: center; }

    .process-step { display: flex; align-items: flex-start; gap: 1.5rem; text-align: left; }
    .step-number {
      width: 55px; height: 55px;
      background: linear-gradient(135deg, var(--green), #00D45E);
      color: white; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: bold; font-size: 1.4rem;
      flex-shrink: 0;
      box-shadow: 0 6px 20px rgba(0,174,66,0.4);
      border: 3px solid rgba(255,255,255,0.3);
    }
    .step-content h3 { color: var(--green); font-size: 1.35rem; margin-bottom: 0.7rem; font-weight: 700; }
    .step-content p { color: #555; font-size: 1.05rem; line-height: 1.6; margin-bottom: 0.4rem; }

    .btn {
      background: linear-gradient(135deg, var(--green), #00D45E);
      color: white;
      padding: 1rem 2.5rem;
      border-radius: 50px;
      text-decoration: none;
      font-weight: bold;
      font-size: 1rem;
      display: inline-block;
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 8px 25px rgba(0, 174, 66, 0.4);
      border: none;
      margin-top: 1.5rem;
      cursor: pointer;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.6s;
    }
    .btn:hover::before { left: 100%; }
    .btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 15px 40px rgba(0, 174, 66, 0.6); }

    /* ===== FORM ===== */
    .form-wrap { text-align: left; max-width: 720px; margin: 2rem auto 0; }
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .form-grid .full { grid-column: 1 / -1; }

    .label { display: block; font-weight: 700; color: #2b2b2b; margin: 0.2rem 0 0.35rem; font-size: 0.95rem; }

    input[type="text"], input[type="email"], input[type="number"], textarea, select {
      width: 100%;
      padding: 1rem 1.1rem;
      border: 2px solid rgba(255,255,255,0.5);
      border-radius: 15px;
      background: rgba(255,255,255,0.95);
      font-size: 1rem;
      transition: all 0.3s ease;
      font-family: inherit;
    }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--green);
      box-shadow: 0 0 0 3px rgba(0, 174, 66, 0.2);
      transform: scale(1.01);
    }

    .choice-group { display: grid; grid-template-columns: repeat(4, minmax(140px, 1fr)); gap: 0.6rem; }

    .choice {
      display: flex; gap: 0.55rem; align-items: center;
      padding: 0.85rem 0.9rem;
      border-radius: 16px;
      cursor: pointer;
      user-select: none;
      border: 2px solid rgba(0, 174, 66, 0.18);
      background: rgba(255,255,255,0.8);
      transition: all 0.25s ease;
    }
    .choice:hover {
      border-color: rgba(0, 174, 66, 0.5);
      box-shadow: 0 10px 22px rgba(0,0,0,0.06);
      transform: translateY(-1px);
    }
    .choice input { accent-color: var(--green); }
    .choice b { color: var(--green); font-size: 0.95rem; }
    .choice span { color: #4b4b4b; font-size: 0.9rem; }

    .hint { margin-top: 0.35rem; color: #5a5a5a; font-size: 0.92rem; opacity: 0.95; }

    .file-box {
      border-radius: 18px;
      border: 2px dashed rgba(0, 174, 66, 0.35);
      background: rgba(255,255,255,0.75);
      padding: 1rem;
    }
    .file-row { display: grid; grid-template-columns: 1fr; gap: 0.6rem; }
    .file-input {
      width: 100%;
      padding: 0.9rem;
      border-radius: 14px;
      border: 2px solid rgba(255,255,255,0.5);
      background: rgba(255,255,255,0.95);
    }
    .files-list { font-size: 0.92rem; color: #4d4d4d; line-height: 1.4; margin-top: 0.35rem; }
    .files-list .item { padding: 0.25rem 0; border-bottom: 1px solid rgba(0,0,0,0.06); }

    .hidden { display: none !important; }

    /* ===== CALC ===== */
    .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .calc-grid .full { grid-column: 1 / -1; }

    .calc-note {
      margin: 0.4rem 0 0;
      color: #5a5a5a;
      font-size: 0.95rem;
      line-height: 1.45;
      text-align: left;
    }

    .calc-kpi {
      background: rgba(255,255,255,0.92);
      border-radius: 22px;
      padding: 1.2rem 1.2rem;
      border: 2px solid rgba(0,174,66,0.22);
      text-align: left;
    }
    .calc-kpi h4 { margin-bottom: 0.35rem; color: var(--green); font-size: 1.1rem; }

    .calc-price {
      display: flex;
      align-items: baseline;
      gap: 0.8rem;
      flex-wrap: wrap;
      margin: 0.1rem 0 0.2rem;
    }
    #calcFinal { font-size: 2.45rem; font-weight: 900; color: #1f1f1f; letter-spacing: -0.6px; }
    #calcOld { font-size: 1.1rem; font-weight: 800; color: #7a7a7a; text-decoration: line-through; text-decoration-thickness: 2px; }
    .calc-sub { margin-top: 0.2rem; color: #5a5a5a; font-size: 0.95rem; line-height: 1.35; }

    /* ===== FAQ ===== */
    .faq { margin-top: 1.2rem; text-align: left; }
    .faq details {
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid rgba(0, 174, 66, 0.18);
      border-radius: 18px;
      padding: 0.9rem 1rem;
      margin: 0.6rem 0;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }
    .faq summary { cursor: pointer; font-weight: 800; color: #1f1f1f; outline: none; }
    .faq p { margin-top: 0.7rem; color: #555; font-size: 0.98rem; line-height: 1.55; }

    /* ===== Filament carousel (scroll snap) ===== */
    .filament-carousel{
      display: grid;
      grid-template-columns: 44px 1fr 44px;
      gap: 0.8rem;
      align-items: center;
    }
    .fc-btn{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      border: 2px solid rgba(0, 174, 66, 0.22);
      background: rgba(255,255,255,0.92);
      color: var(--green);
      font-size: 1.6rem;
      font-weight: 900;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    .fc-btn:hover{ transform: translateY(-1px); box-shadow: 0 14px 30px rgba(0,0,0,0.12); }

    .fc-viewport{
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(240px, 1fr);
      gap: 1rem;
      overflow-x: auto;
      padding: 0.3rem 0.2rem;
      scroll-snap-type: x mandatory;
      overscroll-behavior-x: contain;
      scrollbar-width: none;
    }
    .fc-viewport::-webkit-scrollbar{ display: none; }

    .fc-item{
      scroll-snap-align: center;
      border-radius: 22px;
      border: 2px solid rgba(0, 174, 66, 0.18);
      background: rgba(255,255,255,0.92);
      padding: 1rem;
      box-shadow: 0 10px 24px rgba(0,0,0,0.08);
      text-align: left;
    }
    .fc-img{
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 18px;
      border: 1px solid rgba(0,0,0,0.08);
      background: rgba(0,0,0,0.03);
    }
    .fc-name{ margin-top: 0.85rem; font-weight: 900; color: #1f1f1f; font-size: 1.05rem; }

    .fc-status{
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      margin-top: 0.6rem;
      padding: 0.35rem 0.65rem;
      border-radius: 999px;
      font-weight: 900;
      font-size: 0.92rem;
      border: 1px solid rgba(0,0,0,0.08);
    }
    .fc-status.in{
      color: #0b3b1e;
      background: rgba(0, 174, 66, 0.12);
      border-color: rgba(0, 174, 66, 0.25);
    }
    .fc-status.preorder{
      color: #5a0b0b;
      background: rgba(220, 38, 38, 0.12);
      border-color: rgba(220, 38, 38, 0.25);
    }
    .fc-sub{ margin-top: 0.5rem; color: #555; font-size: 0.95rem; line-height: 1.35; }

    .fc-dots{
      display: flex;
      gap: 0.45rem;
      justify-content: center;
      margin-top: 0.9rem;
      flex-wrap: wrap;
    }
    .fc-dot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.12);
      background: rgba(0,0,0,0.10);
      cursor: pointer;
    }
    .fc-dot.active{
      background: rgba(0, 174, 66, 0.65);
      border-color: rgba(0, 174, 66, 0.7);
    }

    @media (max-width: 1024px) {
      :root { --card-width: 90vw; }
      .nav-glass { height: 75px; padding: 0 15px; }
      .advantages-grid { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
      .choice-group { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 768px) {
      :root { --card-width: 100vw; }
      .nav-glass { top: 8px; height: 85px; border-radius: 30px; padding: 8px 12px; }
      .nav-glass nav ul { flex-wrap: wrap !important; gap: 0.3rem !important; }
      .nav-glass nav a {
        padding: 0.45rem 0.6rem !important;
        font-size: 0.75rem !important;
        flex: 1 1 calc(48% - 0.3rem);
        max-width: none;
        min-width: 70px;
      }

      section { padding: 105px 8px 30px !important; }
      .card { padding: 2rem 1.5rem !important; border-radius: 25px; max-width: 95vw; }

      .advantages-grid { grid-template-columns: repeat(2, 1fr) !important; gap: 1rem; }
      .advantage-item { height: 200px; padding: 1.2rem 0.8rem; }

      .process-step { flex-direction: column; text-align: center; gap: 1.2rem; }
      .step-number, .advantage-icon { align-self: center; margin-bottom: 0.8rem; }
      .content-item, .process-step { padding: 1.5rem 1.2rem; }

      .form-grid { grid-template-columns: 1fr; }
      .choice-group { grid-template-columns: 1fr; }
      .calc-grid { grid-template-columns: 1fr; }

      .filament-carousel{ grid-template-columns: 38px 1fr 38px; }
      .fc-btn{ width: 38px; height: 38px; border-radius: 12px; }
      .fc-img{ height: 160px; }
    }

    @media (max-width: 480px) {
      .nav-glass { height: 90px; padding: 6px 10px; border-radius: 25px; }
      .card { padding: 1.8rem 1.2rem !important; }
      .service-price { font-size: 2rem; }
      .step-number { width: 50px; height: 50px; font-size: 1.3rem; }
      .advantages-grid { grid-template-columns: 1fr !important; }
      .advantage-item { height: 180px; }
    }

    /* ===== Filament carousel (enhanced) ===== */
    .filament-carousel{
      display: grid;
      grid-template-columns: 44px 1fr 44px;
      gap: 0.8rem;
      align-items: center;
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
    }
    .fc-viewport{
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(240px, 1fr);
      gap: 1rem;
      overflow-x: auto;
      padding: 0.3rem 0.2rem;
      scroll-snap-type: x mandatory;
      overscroll-behavior-x: contain;
      scrollbar-width: none;
    }
    .fc-viewport::-webkit-scrollbar{ display: none; }

    .fc-item{
      scroll-snap-align: center;
      border-radius: 22px;
      border: 2px solid rgba(0, 174, 66, 0.18);
      background: rgba(255,255,255,0.92);
      padding: 1rem;
      box-shadow: 0 10px 24px rgba(0,0,0,0.08);
      text-align: left;
    }
    .fc-img{
      width: 100%;
      aspect-ratio: 1 / 1;
      height: auto;
      object-fit: cover;
      border-radius: 18px;
      border: 1px solid rgba(0,0,0,0.08);
      background: rgba(0,0,0,0.03);
      cursor: pointer;
    }
    .fc-name{ margin-top: 0.85rem; font-weight: 900; color: #1f1f1f; font-size: 1.05rem; }

    .fc-status{
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      margin-top: 0.6rem;
      padding: 0.35rem 0.65rem;
      border-radius: 999px;
      font-weight: 900;
      font-size: 0.92rem;
      border: 1px solid rgba(0,0,0,0.08);
    }
    .fc-status.in{
      color: #0b3b1e;
      background: rgba(0, 174, 66, 0.12);
      border-color: rgba(0, 174, 66, 0.25);
    }
    .fc-status.preorder{
      color: #5a0b0b;
      background: rgba(220, 38, 38, 0.12);
      border-color: rgba(220, 38, 38, 0.25);
    }

    .fc-details{ margin-top: 0.75rem; }
    .fc-details summary{ cursor: pointer; font-weight: 900; color: #1f1f1f; }
    .fc-specs{ margin: 0.6rem 0 0; padding-left: 1.2rem; color: #555; font-size: 0.95rem; line-height: 1.35; }
    .fc-specs li{ margin: 0.25rem 0; }

    .fc-add{
      width: 100%;
      margin-top: 0.9rem;
      padding: 0.9rem 1.2rem;
      border-radius: 18px;
      border: none;
      cursor: pointer;
      font-weight: 900;
      font-size: 0.98rem;
      color: white;
      background: linear-gradient(135deg, var(--green), #00D45E);
      box-shadow: 0 8px 25px rgba(0, 174, 66, 0.35);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    .fc-add:hover{ transform: translateY(-2px); box-shadow: 0 14px 34px rgba(0, 174, 66, 0.5); }
    .fc-add:active{ transform: translateY(0); }

    .pill{
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.45rem 0.7rem;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.10);
      background: rgba(255,255,255,0.85);
      margin: 0.25rem 0.35rem 0 0;
      font-weight: 800;
      color: #1f1f1f;
      font-size: 0.92rem;
    }
    .pill button{
      border: none;
      background: transparent;
      cursor: pointer;
      font-weight: 900;
      color: rgba(0,0,0,0.55);
      padding: 0 0.15rem;
    }
    .pill button:hover{ color: rgba(0,0,0,0.85); }

    /* ===== Filament image modal ===== */
    .img-modal{
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      background: rgba(0,0,0,0.35);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      padding: 18px;
    }
    .img-modal.open{ display: flex; }
    .img-modal__panel{
      width: min(980px, 92vw);
      max-height: 88vh;
      background: rgba(255,255,255,0.92);
      border-radius: 24px;
      border: 1px solid rgba(0, 174, 66, 0.18);
      box-shadow: 0 22px 90px rgba(0,0,0,0.35);
      overflow: hidden;
      position: relative;
    }
    .img-modal__bar{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(0,0,0,0.06);
    }
    .img-modal__title{
      font-weight: 900;
      color: #1f1f1f;
      font-size: 1rem;
      text-align: left;
    }
    .img-modal__close{
      width: 42px;
      height: 42px;
      border-radius: 14px;
      border: 2px solid rgba(0, 174, 66, 0.22);
      background: rgba(255,255,255,0.92);
      color: var(--green);
      font-size: 1.25rem;
      font-weight: 900;
      cursor: pointer;
    }
    .img-modal__img{
      width: 100%;
      height: auto;
      max-height: calc(88vh - 60px);
      object-fit: contain;
      background: rgba(0,0,0,0.02);
      display: block;
    }

  </style>
</head>

<body>
  <div class="nav-glass">
    <nav>
      <ul>
        <li><a href="#home">Р“Р»Р°РІРЅР°СЏ</a></li>
        <li><a href="#services">РЈСЃР»СѓРіРё</a></li>
        <li><a href="#calculator">РљР°Р»СЊРєСѓР»СЏС‚РѕСЂ</a></li>
        <li><a href="#filament">Р¤РёР»Р°РјРµРЅС‚</a></li>
        <li><a href="#advantages">РџСЂРµРёРјСѓС‰РµСЃС‚РІР°</a></li>
        <li><a href="#faq">FAQ</a></li>
        <li><a href="#process">РџСЂРѕС†РµСЃСЃ</a></li>
        <li><a href="#contacts">Р—Р°СЏРІРєР°</a></li>
      </ul>
    </nav>
  </div>

  <!-- 1) Р“Р»Р°РІРЅР°СЏ -->
  <section id="home">
    <div class="card">
      <h1>3DOPE</h1>
      <p>
        РџРµСЂРјСЊ. РџСЂРёРЅС‚РµСЂ <strong>500Г—500Г—300 РјРј</strong>.<br>
        РџРѕР»РЅРѕРµ РІРѕРїР»РѕС‰РµРЅРёРµ Р’Р°С€РёС… РёРґРµР№ РІ 3D.<br>
        <em>Р’Р°С€Рµ РІСЂРµРјСЏ вЂ” РЅР°С€Р° Р·Р°Р±РѕС‚Р°.</em>
      </p>
      <a href="#calculator" class="btn">Р Р°СЃСЃС‡РёС‚Р°С‚СЊ СЃС‚РѕРёРјРѕСЃС‚СЊ</a>
      <a href="#contacts" class="btn" style="margin-left:0.5rem;">РћСЃС‚Р°РІРёС‚СЊ Р·Р°СЏРІРєСѓ</a>
    </div>
  </section>

  <!-- 2) РЈСЃР»СѓРіРё (С†РµРЅС‹ РѕР±РЅРѕРІР»РµРЅС‹) -->
  <section id="services">
    <div class="card">
      <h2>РќР°С€Рё СѓСЃР»СѓРіРё</h2>
      <p>РџРѕР»РЅС‹Р№ СЃРїРµРєС‚СЂ 3D-С‚РµС…РЅРѕР»РѕРіРёР№</p>

      <div class="content-grid">
        <div class="content-item">
          <div class="service-price">РѕС‚ 2000 в‚Ѕ</div>
          <div class="service-title">РџРѕР»РЅС‹Р№ С†РёРєР»</div>
          <div class="service-desc">
            РћС‚ Р’Р°С€РµР№ РёРґРµРё РґРѕ РіРѕС‚РѕРІРѕР№ РґРµС‚Р°Р»Рё: РјРѕРґРµР»РёСЂРѕРІР°РЅРёРµ + РїРµС‡Р°С‚СЊ.<br>
            <strong>РџРѕР»РЅР°СЏ РѕС‚РІРµС‚СЃС‚РІРµРЅРЅРѕСЃС‚СЊ Р·Р° СЂРµР·СѓР»СЊС‚Р°С‚.</strong>
          </div>
        </div>

        <div class="content-item">
          <div class="service-price">РѕС‚ 1200 в‚Ѕ</div>
          <div class="service-title">3D-РїРµС‡Р°С‚СЊ</div>
          <div class="service-desc">
            РџСЂРёРЅС‚РµСЂ <strong>500Г—500Г—300 РјРј</strong>.<br>
            ABS / ABS+. Р‘С‹СЃС‚СЂРѕ (1вЂ“3 РґРЅСЏ).<br>
            <strong>РџСЂРёС€Р»РёС‚Рµ STL/STP/STEP вЂ” РјС‹ РЅР°РїРµС‡Р°С‚Р°РµРј!</strong>
          </div>
        </div>

        <div class="content-item">
          <div class="service-price">РѕС‚ 800 в‚Ѕ</div>
          <div class="service-title">РРЅР¶РµРЅРµСЂРЅРѕРµ РјРѕРґРµР»РёСЂРѕРІР°РЅРёРµ</div>
          <div class="service-desc">
            РџСЂРёС€Р»РёС‚Рµ СЌСЃРєРёР·/С‡РµСЂС‚С‘Р¶/РёРґРµСЋ вЂ” СЃРґРµР»Р°РµРј 3D-РјРѕРґРµР»СЊ РїРѕРґ РїРµС‡Р°С‚СЊ.<br>
            <strong>РЎС‚РѕРёРјРѕСЃС‚СЊ Р·Р°РІРёСЃРёС‚ РѕС‚ СЃР»РѕР¶РЅРѕСЃС‚Рё Рё С‚СЂРµР±РѕРІР°РЅРёР№.</strong>
          </div>
        </div>
      </div>

      <a href="#contacts" class="btn">РћСЃС‚Р°РІРёС‚СЊ Р·Р°СЏРІРєСѓ</a>
    </div>
  </section>

  <!-- 3) РљР°Р»СЊРєСѓР»СЏС‚РѕСЂ -->
  <section id="calculator">
    <div class="card">
      <h2>РљР°Р»СЊРєСѓР»СЏС‚РѕСЂ РїРµС‡Р°С‚Рё</h2>
      <p>
        РџСЂРёРјРµСЂРЅР°СЏ С†РµРЅР° <strong>С‚РѕР»СЊРєРѕ Р·Р° РїРµС‡Р°С‚СЊ</strong> РєРѕРїРёР№ РѕРґРЅРѕР№ Рё С‚РѕР№ Р¶Рµ РјРѕРґРµР»Рё (Р±РµР· РјРѕРґРµР»РёСЂРѕРІР°РЅРёСЏ).<br>
        РњРѕРґРµР»РёСЂРѕРІР°РЅРёРµ СЃС‡РёС‚Р°РµС‚СЃСЏ РёРЅРґРёРІРёРґСѓР°Р»СЊРЅРѕ, РѕР±С‹С‡РЅРѕ 800вЂ“3000 в‚Ѕ. РџРѕСЃР»Рµ РјРѕРґРµР»РёСЂРѕРІР°РЅРёСЏ РїРµС‡Р°С‚СЊ СЃС‡РёС‚Р°РµРј РїРѕ СЌС‚РѕРјСѓ РєР°Р»СЊРєСѓР»СЏС‚РѕСЂСѓ.
      </p>

      <div class="content-grid">
        <div class="content-item">
          <div class="calc-grid">
            <div>
              <label class="label" for="calcMaterial">РњР°С‚РµСЂРёР°Р»</label>
              <select id="calcMaterial">
                <option value="abs_red" data-ppg="8">РљСЂР°СЃРЅС‹Р№ ABS</option>
                <option value="absplus_black" data-ppg="10">Р§РµСЂРЅС‹Р№ ABS+</option>
              </select>
            </div>

            <div>
              <label class="label" for="calcWeightG">Р’РµСЃ РѕРґРЅРѕР№ РґРµС‚Р°Р»Рё (Рі)</label>
              <input id="calcWeightG" type="number" min="0" step="1" value="50" />
            </div>

            <div>
              <label class="label" for="calcQty">РљРѕР»РёС‡РµСЃС‚РІРѕ (С€С‚)</label>
              <input id="calcQty" type="number" min="1" step="1" value="1" />
            </div>

            <div>
              <label class="label" for="calcUrgent">РЎСЂРѕС‡РЅРѕСЃС‚СЊ</label>
              <select id="calcUrgent">
                <option value="0">РЎС‚Р°РЅРґР°СЂС‚</option>
                <option value="1">РЎСЂРѕС‡РЅРѕ (+700 в‚Ѕ)</option>
              </select>
            </div>

            <div class="full">
              <label class="choice" style="width:100%; justify-content:flex-start;">
                <input id="calcStrength" type="checkbox">
                <div>
                  <b>РќСѓР¶РЅР° РїРѕРІС‹С€РµРЅРЅР°СЏ РїСЂРѕС‡РЅРѕСЃС‚СЊ</b><br>
                  <span>Р‘РµР· РЅР°С†РµРЅРєРё (СѓС‡С‚С‘Рј РІ РЅР°СЃС‚СЂРѕР№РєР°С… РїРµС‡Р°С‚Рё)</span>
                </div>
              </label>
            </div>

            <div class="full">
              <div class="calc-kpi">
                <h4>РС‚РѕРі (РїРµС‡Р°С‚СЊ)</h4>

                <div class="calc-price">
                  <span id="calcFinal">вЂ” в‚Ѕ</span>
                  <span id="calcOld" class="hidden">вЂ” в‚Ѕ</span>
                </div>

                <div class="calc-sub" id="calcSub">вЂ”</div>

                <div style="text-align:center;">
                  <button type="button" class="btn" id="calcToFormBtn">РџРµСЂРµРЅРµСЃС‚Рё РІ Р·Р°СЏРІРєСѓ</button>
                </div>
              </div>

              <div class="calc-note">
                Р’ С†РµРЅСѓ РґРѕР±Р°РІР»СЏРµС‚СЃСЏ: +400 в‚Ѕ Р·Р° РјРѕРґРµР»СЊ (РїРѕРґРіРѕС‚РѕРІРєР°/Р·Р°РїСѓСЃРє). РЎРєРёРґРєР° 10/50/100 С€С‚ РїСЂРёРјРµРЅСЏРµС‚СЃСЏ Рє РїРµС‡Р°С‚Рё (РЅРµ Рє РґРѕРїР»Р°С‚Р°Рј).
              </div>
            </div>

          </div>
        </div>
      </div>

      <a href="#contacts" class="btn">РџРµСЂРµР№С‚Рё Рє Р·Р°СЏРІРєРµ</a>
    </div>
  </section>

  <!-- 4) Р¤РёР»Р°РјРµРЅС‚ -->
  <section id="filament">
    <div class="card">
      <h2>Р¤РёР»Р°РјРµРЅС‚</h2>
<div class="content-grid">
        <div class="content-item">
          <div class="filament-carousel">
            <button class="fc-btn" id="fcPrev" type="button" aria-label="РџСЂРµРґС‹РґСѓС‰РёР№ С„РёР»Р°РјРµРЅС‚">вЂ№</button>
            <div class="fc-viewport" id="fcViewport" aria-label="РљР°СЂСѓСЃРµР»СЊ С„РёР»Р°РјРµРЅС‚Р°"></div>
            <button class="fc-btn" id="fcNext" type="button" aria-label="РЎР»РµРґСѓСЋС‰РёР№ С„РёР»Р°РјРµРЅС‚">вЂє</button>
          </div>

          <div class="fc-dots" id="fcDots" aria-label="РРЅРґРёРєР°С‚РѕСЂС‹ РєР°СЂСѓСЃРµР»Рё"></div>

          <div class="hint" style="text-align:left;margin-top:0.8rem;">
            ABS+ РѕС‚ РѕР±С‹С‡РЅРѕРіРѕ ABS РѕС‚Р»РёС‡Р°РµС‚СЃСЏ РїРѕРІС‹С€РµРЅРЅРѕР№ Р·Р°С‰РёС‚РѕР№ РѕС‚ СѓР»СЊС‚СЂР°С„РёРѕР»РµС‚Р°, Р±РµРЅР·РѕРјР°СЃР»Рѕ СЃС‚РѕР№РєРёР№, РёРјРµРµС‚ РїРѕРІС‹С€РµРЅСѓСЋ РїР»РѕС‚РЅРѕСЃС‚СЊ, СЃРѕРѕС‚РІРµС‚СЃС‚РІРµРЅРЅРѕ РїСЂРѕС‡РЅРµРµ РѕР±С‹С‡РЅРѕРіРѕ ABS
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 5) РџСЂРµРёРјСѓС‰РµСЃС‚РІР° -->
  <section id="advantages" style="min-height: 80vh; padding: 120px 20px 60px;">
    <div class="card">
      <h2>РџРѕС‡РµРјСѓ РІС‹Р±РёСЂР°СЋС‚ РЅР°СЃ</h2>
      <p>РќР°С€Рё РєР»СЋС‡РµРІС‹Рµ РїСЂРµРёРјСѓС‰РµСЃС‚РІР°</p>

      <div class="advantages-grid">
        <div class="advantage-item">
          <div class="advantage-icon">рџ’°</div>
          <div class="advantage-title">РџРѕРЅСЏС‚РЅР°СЏ С†РµРЅР°</div>
          <div class="advantage-desc">РџСЂРѕР·СЂР°С‡РЅС‹Р№ СЂР°СЃС‡С‘С‚ + СѓС‚РѕС‡РЅРµРЅРёРµ РїРѕ Р·Р°РґР°С‡Рµ</div>
        </div>

        <div class="advantage-item">
          <div class="advantage-icon">вљЎ</div>
          <div class="advantage-title">Р‘С‹СЃС‚СЂРѕ 1вЂ“3 РґРЅСЏ</div>
          <div class="advantage-desc">РЎСЂРѕРєРё СЃРѕРіР»Р°СЃСѓРµРј Р·Р°СЂР°РЅРµРµ</div>
        </div>

        <div class="advantage-item">
          <div class="advantage-icon">рџ“Џ</div>
          <div class="advantage-title">500Г—500Г—300</div>
          <div class="advantage-desc">Р‘РѕР»СЊС€Р°СЏ РѕР±Р»Р°СЃС‚СЊ РїРµС‡Р°С‚Рё</div>
        </div>

        <div class="advantage-item">
          <div class="advantage-icon">рџ§µ</div>
          <div class="advantage-title">РњР°С‚РµСЂРёР°Р»С‹ eSUN</div>
          <div class="advantage-desc">РСЃРїРѕР»СЊР·СѓРµРј С‚РѕР»СЊРєРѕ РєР°С‡РµСЃС‚РІРµРЅРЅС‹Рµ РјР°С‚РµСЂРёР°Р»С‹ Р±СЂРµРЅРґР° Esun</div>
        </div>

        <div class="advantage-item">
          <div class="advantage-icon">рџЏ­</div>
          <div class="advantage-title">РџР°СЂС‚РёРё</div>
          <div class="advantage-desc">РЎРєРёРґРєР° РґРѕ 15% РЅР° РєРѕР»РёС‡РµСЃС‚РІРѕ</div>
        </div>

        <div class="advantage-item">
          <div class="advantage-icon">вњ…</div>
          <div class="advantage-title">Р“Р°СЂР°РЅС‚РёСЏ 7 РґРЅРµР№</div>
          <div class="advantage-desc">РџРµСЂРµРґРµР»РєРё РІ СЂР°РјРєР°С… РіР°СЂР°РЅС‚РёРё</div>
        </div>
      </div>
    </div>
  </section>

  <!-- 6) FAQ -->
  <section id="faq">
    <div class="card">
      <h2>FAQ</h2>
      <p>РљРѕСЂРѕС‚РєРёРµ РѕС‚РІРµС‚С‹ РЅР° С‡Р°СЃС‚С‹Рµ РІРѕРїСЂРѕСЃС‹</p>

      <div class="faq">
        <details>
          <summary>РљР°РєРёРµ С„Р°Р№Р»С‹ РІС‹ РїСЂРёРЅРёРјР°РµС‚Рµ РґР»СЏ РїРµС‡Р°С‚Рё?</summary>
          <p>РћР±С‹С‡РЅРѕ РґР»СЏ РїРµС‡Р°С‚Рё РїРѕРґРѕР№РґСѓС‚ STL/STP/STEP. Р•СЃР»Рё С„Р°Р№Р»Р° РЅРµС‚ вЂ” РјРѕР¶РµРј СЃРјРѕРґРµР»РёСЂРѕРІР°С‚СЊ РїРѕ С„РѕС‚Рѕ/СЌСЃРєРёР·Сѓ.</p>
        </details>

        <details>
          <summary>РЎРєРѕР»СЊРєРѕ СЃС‚РѕРёС‚ РјРѕРґРµР»РёСЂРѕРІР°РЅРёРµ?</summary>
          <p>РњРѕРґРµР»РёСЂРѕРІР°РЅРёРµ СЃС‡РёС‚Р°РµС‚СЃСЏ РёРЅРґРёРІРёРґСѓР°Р»СЊРЅРѕ. РћР±С‹С‡РЅРѕ 800вЂ“3000 в‚Ѕ РІ Р·Р°РІРёСЃРёРјРѕСЃС‚Рё РѕС‚ СЃР»РѕР¶РЅРѕСЃС‚Рё.</p>
        </details>

        <details>
          <summary>РљР°РєРёРµ РјР°С‚РµСЂРёР°Р»С‹ РґРѕСЃС‚СѓРїРЅС‹?</summary>
          <p>Р¤РёР»Р°РјРµРЅС‚ РµСЃС‚СЊ РІ РЅР°Р»РёС‡РёРё Рё РїРѕРґ Р·Р°РєР°Р·. РЎРєРѕСЂРѕ РґРѕР±Р°РІРёРј РѕС‚РґРµР»СЊРЅС‹Р№ Р±Р»РѕРє СЃ РґРѕСЃС‚СѓРїРЅС‹Рј С„РёР»Р°РјРµРЅС‚РѕРј Рё Р°РєС‚СѓР°Р»СЊРЅС‹Рј СЃС‚Р°С‚СѓСЃРѕРј.</p>
        </details>

        <details>
          <summary>РџРѕС‡РµРјСѓ С†РµРЅР° РјРѕР¶РµС‚ Р±С‹С‚СЊ РІС‹С€Рµ, С‡РµРј РІ РєР°Р»СЊРєСѓР»СЏС‚РѕСЂРµ?</summary>
          <p>Р•СЃР»Рё РґРµС‚Р°Р»СЊ РѕС‡РµРЅСЊ РєСЂРёРІРѕР»РёРЅРµР№РЅР°СЏ/СЃР»РѕР¶РЅР°СЏ, РјРѕР¶РµС‚ РїРѕС‚СЂРµР±РѕРІР°С‚СЊСЃСЏ Р±РѕР»СЊС€Рµ РїРѕРґРґРµСЂР¶РµРє, РІСЂРµРјРµРЅРё РїРµС‡Р°С‚Рё Рё РїРѕСЃС‚РѕР±СЂР°Р±РѕС‚РєРё вЂ” С‚РѕРіРґР° С†РµРЅР° Р±СѓРґРµС‚ РІС‹С€Рµ.</p>
        </details>

        <details>
          <summary>РљР°РєРёРµ СЃСЂРѕРєРё РїРµС‡Р°С‚Рё?</summary>
          <p>РЎС‚Р°РЅРґР°СЂС‚РЅРѕ 1вЂ“3 РґРЅСЏ, СЃСЂРѕС‡РЅС‹Рµ Р·Р°РєР°Р·С‹ вЂ” РїРѕ СЃРѕРіР»Р°СЃРѕРІР°РЅРёСЋ.</p>
        </details>

        <details>
          <summary>РњРѕР¶РЅРѕ Р»Рё СЃРґРµР»Р°С‚СЊ РїСЂРѕС‡РЅРµРµ?</summary>
          <p>Р”Р°, РѕС‚РјРµС‚СЊС‚Рµ вЂњРїРѕРІС‹С€РµРЅРЅР°СЏ РїСЂРѕС‡РЅРѕСЃС‚СЊвЂќ вЂ” РїРѕРґР±РµСЂС‘Рј РЅР°СЃС‚СЂРѕР№РєРё РїРµС‡Р°С‚Рё (Р±РµР· РЅР°С†РµРЅРєРё).</p>
        </details>

        <details>
          <summary>РљР°РєРёРµ РјР°РєСЃРёРјР°Р»СЊРЅС‹Рµ РіР°Р±Р°СЂРёС‚С‹ РїРµС‡Р°С‚Рё?</summary>
          <p>Р”Рѕ 500Г—500Г—300 РјРј (РµСЃР»Рё РґРµС‚Р°Р»СЊ Р±РѕР»СЊС€Рµ вЂ” РїСЂРµРґР»РѕР¶РёРј РїРµС‡Р°С‚СЊ С‡Р°СЃС‚СЏРјРё Рё СЃРєР»РµР№РєСѓ/СЃР±РѕСЂРєСѓ).</p>
        </details>

        <details>
          <summary>Р§С‚Рѕ РЅСѓР¶РЅРѕ РЅР°РїРёСЃР°С‚СЊ РІ Р·Р°СЏРІРєРµ, С‡С‚РѕР±С‹ Р±С‹СЃС‚СЂРѕ РїРѕСЃС‡РёС‚Р°С‚СЊ?</summary>
          <p>РћРїРёС€РёС‚Рµ РЅР°Р·РЅР°С‡РµРЅРёРµ РґРµС‚Р°Р»Рё, СѓСЃР»РѕРІРёСЏ (РЅР°РіСЂСѓР·РєР°/С‚РµРјРїРµСЂР°С‚СѓСЂР°/СѓР»РёС†Р°), Р¶РµР»Р°РµРјС‹Рµ СЃСЂРѕРєРё Рё РїСЂРёР»РѕР¶РёС‚Рµ С„Р°Р№Р»/СЌСЃРєРёР·.</p>
        </details>
      </div>
    </div>
  </section>

  <!-- 7) РџСЂРѕС†РµСЃСЃ -->
  <section id="process">
    <div class="card">
      <h2>РљР°Рє СЌС‚Рѕ СЂР°Р±РѕС‚Р°РµС‚</h2>
      <p>РџСЂРѕР·СЂР°С‡РЅС‹Р№ РїСЂРѕС†РµСЃСЃ РѕС‚ Р·Р°СЏРІРєРё РґРѕ РіРѕС‚РѕРІРѕР№ РґРµС‚Р°Р»Рё</p>

      <div class="process-container">
        <div class="process-step">
          <div class="step-number">1</div>
          <div class="step-content">
            <h3>РќР°РїРёС€РёС‚Рµ РЅР°Рј Р·Р°РґР°С‡Сѓ</h3>
            <p>РЈРєР°Р¶РёС‚Рµ С‡С‚Рѕ РЅСѓР¶РЅРѕ: РјРѕРґРµР»РёСЂРѕРІР°РЅРёРµ, РїРµС‡Р°С‚СЊ РёР»Рё РїРѕР»РЅС‹Р№ С†РёРєР».</p>
          </div>
        </div>

        <div class="process-step">
          <div class="step-number">2</div>
          <div class="step-content">
            <h3>РџСЂРёС€Р»РёС‚Рµ РјР°С‚РµСЂРёР°Р»С‹</h3>
            <p>Р¤РѕС‚Рѕ/СЌСЃРєРёР·/С‡РµСЂС‚С‘Р¶, Р° РµСЃР»Рё РїРµС‡Р°С‚СЊ вЂ” STL/STP/STEP.</p>
          </div>
        </div>

        <div class="process-step">
          <div class="step-number">3</div>
          <div class="step-content">
            <h3>РЎРѕРіР»Р°СЃСѓРµРј С†РµРЅСѓ Рё СЃСЂРѕРєРё</h3>
            <p>РџРѕРґС‚РІРµСЂР¶РґР°РµРј СЃС‚РѕРёРјРѕСЃС‚СЊ Рё РЅР°Р·С‹РІР°РµРј СЃСЂРѕРє.</p>
          </div>
        </div>

        <div class="process-step">
          <div class="step-number">4</div>
          <div class="step-content">
            <h3>РџРµС‡Р°С‚Р°РµРј / РјРѕРґРµР»РёСЂСѓРµРј</h3>
            <p>Р Р°Р±РѕС‚Р°РµРј Р°РєРєСѓСЂР°С‚РЅРѕ, РґРµСЂР¶РёРј СЃРІСЏР·СЊ РїРѕ РїСЂРѕРіСЂРµСЃСЃСѓ.</p>
          </div>
        </div>

        <div class="process-step">
          <div class="step-number">5</div>
          <div class="step-content">
            <h3>Р“РѕС‚РѕРІРѕ</h3>
            <p>РџРµСЂРµРґР°С‘Рј РґРµС‚Р°Р»СЊ Рё РїСЂРё РЅРµРѕР±С…РѕРґРёРјРѕСЃС‚Рё РїСЂР°РІРёРј РІ СЂР°РјРєР°С… РіР°СЂР°РЅС‚РёРё.</p>
          </div>
        </div>
      </div>

      <a href="#contacts" class="btn">РќР°С‡Р°С‚СЊ РїСЂРѕРµРєС‚</a>
    </div>
  </section>

  <!-- 8) Р—Р°СЏРІРєР° -->
  <section id="contacts">
    <div class="card">
      <h2>РћСЃС‚Р°РІРёС‚СЊ Р·Р°СЏРІРєСѓ</h2>
      <p>РћРїРёС€РёС‚Рµ Р·Р°РґР°С‡Сѓ, РІС‹Р±РµСЂРёС‚Рµ С‚РёРї Р·Р°РїСЂРѕСЃР° Рё РїСЂРёРєСЂРµРїРёС‚Рµ С„Р°Р№Р»С‹</p>

      <div class="form-wrap">
        <form id="requestForm">
          <div class="form-grid">
            <div class="full">
              <label class="label" for="clientContact">РљРѕРЅС‚Р°РєС‚ (С‚РµР»РµС„РѕРЅ / Telegram / email)</label>
              <input id="clientContact" type="text" placeholder="РќР°РїСЂРёРјРµСЂ: +7... РёР»Рё @username" required>
            </div>

            <div class="full">
              <label class="label" for="taskDesc">РћРїРёСЃР°РЅРёРµ Р·Р°РґР°С‡Рё</label>
              <textarea id="taskDesc" rows="5" placeholder="Р§С‚Рѕ РЅСѓР¶РЅРѕ СЃРґРµР»Р°С‚СЊ? Р“РґРµ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РґРµС‚Р°Р»СЊ? Р’Р°Р¶РЅРѕ Р»Рё СЃРѕРІРїР°РґРµРЅРёРµ СЂР°Р·РјРµСЂРѕРІ?" required></textarea>
              <div class="hint">Р§РµРј С‚РѕС‡РЅРµРµ РѕРїРёСЃР°РЅРёРµ вЂ” С‚РµРј Р±С‹СЃС‚СЂРµРµ РјС‹ РґР°РґРёРј СЃС‚РѕРёРјРѕСЃС‚СЊ Рё СЃСЂРѕРє.</div>
            </div>

            <div class="full">
              <label class="label">РўРёРї Р·Р°РїСЂРѕСЃР°</label>
              <div class="choice-group" role="radiogroup" aria-label="РўРёРї Р·Р°РїСЂРѕСЃР°">
                <label class="choice">
                  <input type="radio" name="requestType" value="modeling" checked>
                  <div><b>РњРѕРґРµР»РёСЂРѕРІР°РЅРёРµ</b><br><span>РЎРґРµР»Р°РµРј 3D-РјРѕРґРµР»СЊ</span></div>
                </label>
                <label class="choice">
                  <input type="radio" name="requestType" value="full">
                  <div><b>РџРѕР»РЅС‹Р№ С†РёРєР»</b><br><span>РњРѕРґРµР»СЊ + РїРµС‡Р°С‚СЊ</span></div>
                </label>
                <label class="choice">
                  <input type="radio" name="requestType" value="print">
                  <div><b>РџРµС‡Р°С‚СЊ</b><br><span>РЈР¶Рµ РµСЃС‚СЊ РјРѕРґРµР»СЊ</span></div>
                </label>
                <label class="choice">
                  <input type="radio" name="requestType" value="question">
                  <div><b>Р’РѕРїСЂРѕСЃ</b><br><span>РќСѓР¶РЅР° РєРѕРЅСЃСѓР»СЊС‚Р°С†РёСЏ</span></div>
                </label>
              </div>
            </div>

            <div class="full" id="materialsBlock">
              <label class="label" for="materialSelect">РњР°С‚РµСЂРёР°Р»</label>
              <select id="materialSelect">
                <option value="abs_red">РљСЂР°СЃРЅС‹Р№ ABS</option>
                <option value="absplus_black">Р§РµСЂРЅС‹Р№ ABS+</option>
              </select>
            </div>

            <div class="full" id="strengthBlock">
              <label class="choice" style="width:100%; justify-content:flex-start;">
                <input id="strengthNeed" type="checkbox">
                <div><b>РќСѓР¶РЅР° РїРѕРІС‹С€РµРЅРЅР°СЏ РїСЂРѕС‡РЅРѕСЃС‚СЊ</b><br><span>Р‘РµР· РЅР°С†РµРЅРєРё (РїРѕР¶РµР»Р°РЅРёРµ Рє РЅР°СЃС‚СЂРѕР№РєР°Рј РїРµС‡Р°С‚Рё)</span></div>
              </label>
            </div>

            <div class="full" id="attachmentsImagesBlock">
              <label class="label" id="attachmentsHint" for="attachmentsImages">РџСЂРёРєСЂРµРїРёС‚Рµ С„РѕС‚Рѕ/СЃРєСЂРёРЅС€РѕС‚ С‡РµСЂС‚РµР¶Р°/СЌСЃРєРёР·Р°</label>
              <div class="file-box">
                <div class="file-row">
                  <input class="file-input" id="attachmentsImages" type="file" multiple accept="image/*,.pdf">
                  <div class="hint">РњРѕР¶РЅРѕ РІС‹Р±СЂР°С‚СЊ РЅРµСЃРєРѕР»СЊРєРѕ С„Р°Р№Р»РѕРІ СЃСЂР°Р·Сѓ.</div>
                  <div id="imagesList" class="files-list"></div>
                </div>
              </div>
            </div>

            <div class="full hidden" id="modelFileBlock">
              <label class="label" for="modelFile">РџСЂРёРєСЂРµРїРёС‚Рµ 3D-С„Р°Р№Р» (STL/STP/STEP)</label>
              <div class="file-box">
                <div class="file-row">
                  <input class="file-input" id="modelFile" type="file" accept=".stl,.stp,.step">
                  <div class="hint">Р•СЃР»Рё С„Р°Р№Р»РѕРІ РјРЅРѕРіРѕ вЂ” РјРѕР¶РЅРѕ РѕС‚РїСЂР°РІРёС‚СЊ Р°СЂС…РёРІРѕРј РїРѕР·Р¶Рµ (РІ Telegram).</div>
                  <div id="modelList" class="files-list"></div>
                </div>
              </div>
            </div>

            <div class="full hidden" id="selectedFilamentsBlock">
              <label class="label">Р’С‹Р±СЂР°РЅРЅС‹Р№ С„РёР»Р°РјРµРЅС‚</label>
              <div id="selectedFilamentsList"></div>
              <div class="hint">Р’С‹Р±СЂР°РЅРЅС‹Рµ РїРѕР·РёС†РёРё РґРѕР±Р°РІСЏС‚СЃСЏ РІ РѕРїРёСЃР°РЅРёРµ Р·Р°СЏРІРєРё Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё.</div>
            </div>


            <div class="full" style="text-align:center;">
              <button type="submit" class="btn">РћС‚РїСЂР°РІРёС‚СЊ Р·Р°РїСЂРѕСЃ</button>
            </div>
          </div>
        </form>

        <p style="margin-top: 1.5rem; opacity: 0.85; font-size: 0.95rem; text-align:center;">
          РњС‹ СЃРІСЏР¶РµРјСЃСЏ СЃ Р’Р°РјРё РІ СЃР°РјРѕРµ Р±Р»РёР¶Р°Р№С€РµРµ РІСЂРµРјСЏ. <strong>РџРµСЂРјСЊ.</strong>
        </p>
      </div>
    </div>
  </section>

  <script>
    // Smooth anchors
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', e => {
        e.preventDefault();
        document.querySelector(a.getAttribute('href')).scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    });

    // ===== Helpers =====
    function setFilesList(target, files) {
      target.innerHTML = '';
      if (!files || files.length === 0) return;
      [...files].forEach(f => {
        const div = document.createElement('div');
        div.className = 'item';
        div.textContent = `${f.name} (${Math.round(f.size / 1024)} KB)`;
        target.appendChild(div);
      });
    }

    

    // ===== Filament -> Request (selected items) =====
    const selectedFilaments = [];
    const selectedFilamentsBlock = document.getElementById('selectedFilamentsBlock');
    const selectedFilamentsList = document.getElementById('selectedFilamentsList');
    const taskDescEl = document.getElementById('taskDesc');

    function rebuildFilamentTextBlock() {
      if (!taskDescEl) return;
      const header = 'Р’С‹Р±СЂР°РЅРЅС‹Р№ С„РёР»Р°РјРµРЅС‚:';
      const lines = selectedFilaments.map((f, i) => `- ${i + 1}) ${f.name} (${f.inStock ? 'РІ РЅР°Р»РёС‡РёРё' : 'РїРѕРґ Р·Р°РєР°Р·'})`);
      const block = lines.length ? (header + '\n' + lines.join('\n')) : '';

      const cur = (taskDescEl.value || '').trim();
      const cleaned = cur.replace(/\n?Р’С‹Р±СЂР°РЅРЅС‹Р№ С„РёР»Р°РјРµРЅС‚:[\s\S]*$/m, '').trim();
      taskDescEl.value = (cleaned + (cleaned ? '\n\n' : '') + block).trim();
    }

    function renderSelectedFilaments() {
      if (!selectedFilamentsBlock || !selectedFilamentsList) return;

      if (selectedFilaments.length === 0) {
        selectedFilamentsBlock.classList.add('hidden');
        selectedFilamentsList.innerHTML = '';
        rebuildFilamentTextBlock();
        return;
      }

      selectedFilamentsBlock.classList.remove('hidden');
      selectedFilamentsList.innerHTML = '';

      selectedFilaments.forEach((f, idx) => {
        const pill = document.createElement('span');
        pill.className = 'pill';
        pill.textContent = `${idx + 1}) ${f.name}`;

        const rm = document.createElement('button');
        rm.type = 'button';
        rm.setAttribute('aria-label', 'РЈРґР°Р»РёС‚СЊ');
        rm.textContent = 'Г—';
        rm.addEventListener('click', () => {
          const i = selectedFilaments.findIndex(x => x.id === f.id);
          if (i >= 0) selectedFilaments.splice(i, 1);
          renderSelectedFilaments();
        });

        pill.appendChild(rm);
        selectedFilamentsList.appendChild(pill);
      });

      rebuildFilamentTextBlock();
    }

    function addFilamentToRequest(f) {
      if (!f) return;
      if (selectedFilaments.some(x => x.id === f.id)) {
        const contacts = document.querySelector('#contacts');
        if (contacts) contacts.scrollIntoView({ behavior: 'smooth', block: 'start' });
        return;
      }

      selectedFilaments.push({
        id: f.id,
        name: f.name,
        inStock: Boolean(f.inStock),
      });

      renderSelectedFilaments();

      const contacts = document.querySelector('#contacts');
      if (contacts) contacts.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
// ===== Form logic =====
    const attachmentsHint = document.getElementById('attachmentsHint');
    const attachmentsImagesBlock = document.getElementById('attachmentsImagesBlock');
    const attachmentsImages = document.getElementById('attachmentsImages');

    const modelFileBlock = document.getElementById('modelFileBlock');
    const modelFile = document.getElementById('modelFile');

    const materialsBlock = document.getElementById('materialsBlock');
    const strengthBlock = document.getElementById('strengthBlock');

    const imagesList = document.getElementById('imagesList');
    const modelList = document.getElementById('modelList');

    function updateFormByType(type) {
      attachmentsImagesBlock.classList.remove('hidden');
      modelFileBlock.classList.add('hidden');

      materialsBlock.classList.add('hidden');
      strengthBlock.classList.add('hidden');

      modelFile.required = false;

      if (type === 'modeling') {
        attachmentsHint.textContent = 'РџСЂРёРєСЂРµРїРёС‚Рµ С„РѕС‚Рѕ/СЃРєСЂРёРЅС€РѕС‚ С‡РµСЂС‚РµР¶Р°/СЌСЃРєРёР·Р°';
      }

      if (type === 'full') {
        attachmentsHint.textContent = 'РџСЂРёРєСЂРµРїРёС‚Рµ С„РѕС‚Рѕ СЃР»РѕРјР°РЅРЅРѕР№ РґРµС‚Р°Р»Рё/СЌСЃРєРёР·/С‡РµСЂС‚РµР¶/РґРµС‚Р°Р»СЊ, Рє РєРѕС‚РѕСЂРѕР№ РґРѕР»Р¶РЅР° РєСЂРµРїРёС‚СЊСЃСЏ';
        materialsBlock.classList.remove('hidden');
        strengthBlock.classList.remove('hidden');
      }

      if (type === 'print') {
        attachmentsImagesBlock.classList.add('hidden');
        modelFileBlock.classList.remove('hidden');
        materialsBlock.classList.remove('hidden');
        strengthBlock.classList.remove('hidden');
        modelFile.required = true;
      }

      if (type === 'question') {
        attachmentsHint.textContent = 'РџСЂРёРєСЂРµРїРёС‚Рµ С„РѕС‚Рѕ/СЃРєСЂРёРЅ (РїРѕ Р¶РµР»Р°РЅРёСЋ)';
      }
    }

    if (typeof selectedFilaments !== 'undefined') { selectedFilaments.length = 0; if (typeof renderSelectedFilaments === 'function') renderSelectedFilaments(); }
      updateFormByType('modeling');

    document.querySelectorAll('input[name="requestType"]').forEach(r => {
      r.addEventListener('change', () => updateFormByType(r.value));
    });

    attachmentsImages.addEventListener('change', () => setFilesList(imagesList, attachmentsImages.files));
    modelFile.addEventListener('change', () => setFilesList(modelList, modelFile.files));

    document.getElementById('requestForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const type = document.querySelector('input[name="requestType"]:checked').value;

      if (type === 'print' && (!modelFile.files || modelFile.files.length === 0)) {
        alert('Р”Р»СЏ "РџРµС‡Р°С‚СЊ" РЅСѓР¶РЅРѕ РїСЂРёРєСЂРµРїРёС‚СЊ STL/STP/STEP С„Р°Р№Р».');
        return;
      }

      alert('вњ… Р—Р°РїСЂРѕСЃ РїСЂРёРЅСЏС‚. РњС‹ СЃРІСЏР¶РµРјСЃСЏ РІ С‚РµС‡РµРЅРёРµ С‡Р°СЃР°.');
      e.target.reset();
      imagesList.innerHTML = '';
      modelList.innerHTML = '';
      updateFormByType('modeling');
    });

    // ===== Calculator logic (РєР°Рє Р±С‹Р»Рѕ + 400 в‚Ѕ Р·Р° РјРѕРґРµР»СЊ) =====
    (function initCalculator() {
      const materialEl = document.getElementById('calcMaterial');
      const weightEl = document.getElementById('calcWeightG');
      const qtyEl = document.getElementById('calcQty');
      const urgentEl = document.getElementById('calcUrgent');
      const strengthEl = document.getElementById('calcStrength');

      const outFinal = document.getElementById('calcFinal');
      const outOld = document.getElementById('calcOld');
      const outSub = document.getElementById('calcSub');
      const toFormBtn = document.getElementById('calcToFormBtn');

      // РќР°СЃС‚СЂРѕР№РєРё
      const MIN_ORDER = 1200;     // РјРёРЅРёРјСѓРј Р·Р°РєР°Р·Р°
      const MIN_PART  = 400;      // РјРёРЅРёРјСѓРј Р·Р° 1 С€С‚
      const URGENT_ADD = 700;     // СЃСЂРѕС‡РЅРѕСЃС‚СЊ С„РёРєСЃ
      const MODEL_FEE  = 400;     // +400 в‚Ѕ Р·Р° РјРѕРґРµР»СЊ (РѕРґРёРЅ СЂР°Р· РЅР° Р·Р°РєР°Р·, С‚.Рє. РїРµС‡Р°С‚Р°РµРј РєРѕРїРёРё РѕРґРЅРѕР№ РјРѕРґРµР»Рё)

      const fmtMoney = (n) => {
        const x = Math.round(Number(n) || 0);
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ') + ' в‚Ѕ';
      };

      function getPPG() {
        const opt = materialEl.options[materialEl.selectedIndex];
        return Number(opt.getAttribute('data-ppg')) || 0;
      }

      function getDiscountByQty(qty) {
        if (qty >= 100) return 0.15;
        if (qty >= 50) return 0.10;
        if (qty >= 10) return 0.05;
        return 0;
      }

      function materialName() {
        const opt = materialEl.options[materialEl.selectedIndex];
        return opt ? opt.textContent.trim() : '';
      }

      function recalc() {
        const ppg = getPPG();
        const weightG = Math.max(0, Number(weightEl.value) || 0);
        const qty = Math.max(1, Math.floor(Number(qtyEl.value) || 1));
        const urgent = Number(urgentEl.value) === 1;

        const discount = getDiscountByQty(qty);

        const plasticOne = weightG * ppg;
        const onePart = Math.max(MIN_PART, plasticOne);

        const printingSum = onePart * qty;
        const urgentFee = urgent ? URGENT_ADD : 0;

        // Р¦РµРЅР° Р±РµР· СЃРєРёРґРєРё
        const oldBase = printingSum + MODEL_FEE + urgentFee;
        const oldPrice = Math.max(MIN_ORDER, oldBase);

        // Р¦РµРЅР° СЃРѕ СЃРєРёРґРєРѕР№: СЃРєРёРґРєР° С‚РѕР»СЊРєРѕ РЅР° РїРµС‡Р°С‚СЊ (printingSum)
        const discountedPrinting = printingSum * (1 - discount);
        const finalBase = discountedPrinting + MODEL_FEE + urgentFee;
        const finalPrice = Math.max(MIN_ORDER, finalBase);

        outFinal.textContent = fmtMoney(finalPrice);

        if (discount > 0 && finalPrice < oldPrice) {
          outOld.textContent = fmtMoney(oldPrice);
          outOld.classList.remove('hidden');
        } else {
          outOld.classList.add('hidden');
        }

        const discountText = discount > 0 ? `СЃРєРёРґРєР° -${Math.round(discount * 100)}%` : 'Р±РµР· СЃРєРёРґРєРё';
        outSub.textContent =
          `${materialName()}, ${weightG} Рі, ${qty} С€С‚, ${urgent ? 'СЃСЂРѕС‡РЅРѕ' : 'СЃС‚Р°РЅРґР°СЂС‚'}, ${discountText} (+400 в‚Ѕ Р·Р° РјРѕРґРµР»СЊ)`;
      }

      function pushToForm() {
        const contacts = document.querySelector('#contacts');
        if (contacts) contacts.scrollIntoView({ behavior: 'smooth', block: 'start' });

        // РІС‹Р±РёСЂР°РµРј "РџРµС‡Р°С‚СЊ"
        const printRadio = document.querySelector('input[name="requestType"][value="print"]');
        if (printRadio) {
          printRadio.checked = true;
          if (typeof updateFormByType === 'function') updateFormByType('print');
        }

        // РїРµСЂРµРЅРѕСЃРёРј С‚РѕР»СЊРєРѕ: РјР°С‚РµСЂРёР°Р», РІРµСЃ, РїСЂРѕС‡РЅРѕСЃС‚СЊ, РєРѕР»РёС‡РµСЃС‚РІРѕ, СЃСЂРѕС‡РЅРѕСЃС‚СЊ
        const formMaterial = document.getElementById('materialSelect');
        if (formMaterial) formMaterial.value = materialEl.value;

        const strengthNeed = document.getElementById('strengthNeed');
        if (strengthNeed) strengthNeed.checked = strengthEl.checked;

        const weightG = Math.max(0, Number(weightEl.value) || 0);
        const qty = Math.max(1, Math.floor(Number(qtyEl.value) || 1));
        const urgent = Number(urgentEl.value) === 1;

        const desc = document.getElementById('taskDesc');
        if (desc) {
          const block =
            `РџР°СЂР°РјРµС‚СЂС‹ РїРµС‡Р°С‚Рё (РёР· РєР°Р»СЊРєСѓР»СЏС‚РѕСЂР°):\n` +
            `- РњР°С‚РµСЂРёР°Р»: ${materialName()}\n` +
            `- Р’РµСЃ (РѕС†РµРЅРєР°): ${weightG} Рі (1 С€С‚)\n` +
            `- РљРѕР»РёС‡РµСЃС‚РІРѕ: ${qty} С€С‚\n` +
            `- РЎСЂРѕС‡РЅРѕСЃС‚СЊ: ${urgent ? 'СЃСЂРѕС‡РЅРѕ' : 'СЃС‚Р°РЅРґР°СЂС‚'}\n` +
            `- РџРѕРІС‹С€РµРЅРЅР°СЏ РїСЂРѕС‡РЅРѕСЃС‚СЊ: ${strengthEl.checked ? 'РґР°' : 'РЅРµС‚'}\n`;

          const cur = desc.value.trim();
          const cleaned = cur.replace(/РџР°СЂР°РјРµС‚СЂС‹ РїРµС‡Р°С‚Рё \(РёР· РєР°Р»СЊРєСѓР»СЏС‚РѕСЂР°\):[\s\S]*$/m, '').trim();
          desc.value = (cleaned + (cleaned ? '\n\n' : '') + block).trim();
        }
      }

      [materialEl, weightEl, qtyEl, urgentEl, strengthEl].forEach(el => {
        el.addEventListener('change', recalc);
        el.addEventListener('input', recalc);
      });
      toFormBtn.addEventListener('click', pushToForm);

      recalc();
    })();

    // ===== Filament carousel (DEFAULT + /content/filament.json) =====
    (function initFilamentCarousel() {
      const DEFAULT_FILAMENTS = [
        {
          id: 'abs_red',
          name: 'РљСЂР°СЃРЅС‹Р№ ABS',
          image: 'images/filament/abs-red.jpg',
          inStock: true,
          specs: [
            { n: 1, name: 'Р”РёР°РјРµС‚СЂ', value: '1.75 РјРј' },
            { n: 2, name: 'РњР°С‚РµСЂРёР°Р»', value: 'ABS' },
          ],
        },
        {
          id: 'absplus_black',
          name: 'Р§РµСЂРЅС‹Р№ ABS+',
          image: 'images/filament/absplus-black.jpg',
          inStock: false,
          specs: [
            { n: 1, name: 'Р”РёР°РјРµС‚СЂ', value: '1.75 РјРј' },
            { n: 2, name: 'РњР°С‚РµСЂРёР°Р»', value: 'ABS+' },
          ],
        },
      ];

      let filaments = DEFAULT_FILAMENTS;

      const viewport = document.getElementById('fcViewport');
      const dotsWrap = document.getElementById('fcDots');
      const prevBtn = document.getElementById('fcPrev');
      const nextBtn = document.getElementById('fcNext');
      if (!viewport || !dotsWrap || !prevBtn || !nextBtn) return;

      // Modal
      const modal = document.getElementById('imgModal');
      const modalImg = document.getElementById('imgModalImg');
      const modalTitle = document.getElementById('imgModalTitle');
      const modalClose = document.getElementById('imgModalClose');

      function openModal(src, title) {
        if (!modal || !modalImg || !modalTitle) return;
        modalImg.src = src;
        modalImg.alt = title || '';
        modalTitle.textContent = title || 'РР·РѕР±СЂР°Р¶РµРЅРёРµ';
        modal.classList.add('open');
      }

      function closeModal() {
        if (!modal || !modalImg) return;
        modal.classList.remove('open');
        modalImg.src = '';
      }

      if (modalClose) modalClose.addEventListener('click', closeModal);
      if (modal) {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) closeModal();
        });
      }
      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal && modal.classList.contains('open')) closeModal();
      });

      const safeId = (s) => String(s || '')
        .toLowerCase()
        .replace(/[^a-z0-9_]+/g, '_')
        .replace(/^_+|_+$/g, '') || ('f_' + Math.random().toString(16).slice(2));

      function buildName(it) {
        const title = (it.title || it.name || '').toString().trim();
        if (title) return title;
        const parts = [it.material || '', it.color || ''].filter(Boolean);
        const base = parts.join(' ').trim();
        const withBrand = (base + (it.brand ? ` В· ${it.brand}` : '')).trim();
        return withBrand || 'Р¤РёР»Р°РјРµРЅС‚';
      }

      async function loadFromJson() {
        try {
          const res = await fetch('/content/filament.json?ts=' + Date.now(), { cache: 'no-store' });
          if (!res.ok) return;
          const data = await res.json();
          const items = Array.isArray(data) ? data : (Array.isArray(data.items) ? data.items : []);
          if (!items.length) return;

          filaments = items.map((it, idx) => {
            const inStock = (it.in_stock ?? it.inStock ?? false) === true;
            const name = buildName(it);

            const specsRaw = Array.isArray(it.specs) ? it.specs : [];
            const specs = specsRaw
              .map((s, i) => ({
                n: (typeof s.n === 'number' && Number.isFinite(s.n)) ? s.n : (parseInt(s.n, 10) || (i + 1)),
                name: (s.name || '').toString(),
                value: (s.value || '').toString(),
              }))
              .filter(x => x.name || x.value)
              .sort((a, b) => a.n - b.n);

            return {
              id: safeId(it.id || name || idx),
              name,
              image: it.image || 'images/filament/placeholder.jpg',
              inStock,
              specs,
            };
          });
        } catch (e) {
          // keep DEFAULT_FILAMENTS
        }
      }

      function render() {
        viewport.innerHTML = '';
        dotsWrap.innerHTML = '';

        filaments.forEach((f, idx) => {
          const item = document.createElement('div');
          item.className = 'fc-item';
          item.dataset.index = String(idx);

          const img = document.createElement('img');
          img.className = 'fc-img';
          img.alt = f.name;
          img.src = f.image;
          img.loading = 'lazy';
          img.decoding = 'async';
          img.onerror = () => { img.style.opacity = '0.15'; };
          img.addEventListener('click', () => openModal(f.image, f.name));

          const name = document.createElement('div');
          name.className = 'fc-name';
          name.textContent = f.name;

          const status = document.createElement('div');
          status.className = 'fc-status ' + (f.inStock ? 'in' : 'preorder');
          status.textContent = f.inStock ? 'Р’ РЅР°Р»РёС‡РёРё' : 'РџРѕРґ Р·Р°РєР°Р·';

          item.appendChild(img);
          item.appendChild(name);
          item.appendChild(status);

          // РћРїРёСЃР°РЅРёРµ (fc-sub) РЅР°РјРµСЂРµРЅРЅРѕ РЅРµ РїРѕРєР°Р·С‹РІР°РµРј

          if (Array.isArray(f.specs) && f.specs.length) {
            const details = document.createElement('details');
            details.className = 'fc-details';

            const summary = document.createElement('summary');
            summary.textContent = 'РҐР°СЂР°РєС‚РµСЂРёСЃС‚РёРєРё';

            const ol = document.createElement('ol');
            ol.className = 'fc-specs';

            f.specs.forEach((s, i) => {
              const li = document.createElement('li');
              const label = (s.name || '').trim();
              const value = (s.value || '').trim();
              if (label && value) li.textContent = `${label}: ${value}`;
              else li.textContent = (label || value || `РџСѓРЅРєС‚ ${i + 1}`);
              ol.appendChild(li);
            });

            details.appendChild(summary);
            details.appendChild(ol);
            item.appendChild(details);
          }

          const addBtn = document.createElement('button');
          addBtn.type = 'button';
          addBtn.className = 'fc-add';
          addBtn.textContent = 'Р”РѕР±Р°РІРёС‚СЊ РІ Р·Р°СЏРІРєСѓ';
          addBtn.addEventListener('click', () => addFilamentToRequest(f));
          item.appendChild(addBtn);

          viewport.appendChild(item);

          const dot = document.createElement('button');
          dot.type = 'button';
          dot.className = 'fc-dot' + (idx === 0 ? ' active' : '');
          dot.setAttribute('aria-label', `РЎР»Р°Р№Рґ ${idx + 1}`);
          dot.addEventListener('click', () => scrollToIndex(idx));
          dotsWrap.appendChild(dot);
        });

        updateActiveDot();
      }

      function getItemStepPx() {
        const first = viewport.querySelector('.fc-item');
        if (!first) return viewport.clientWidth;
        const style = getComputedStyle(viewport);
        const gap = parseFloat(style.columnGap || style.gap || '0') || 0;
        return first.getBoundingClientRect().width + gap;
      }

      function scrollToIndex(index) {
        const idx = Math.max(0, Math.min(filaments.length - 1, index));
        const step = getItemStepPx();
        viewport.scrollTo({ left: step * idx, behavior: 'smooth' });
      }

      function currentIndex() {
        const step = getItemStepPx();
        return Math.max(0, Math.min(filaments.length - 1, Math.round(viewport.scrollLeft / step)));
      }

      function updateActiveDot() {
        const idx = currentIndex();
        [...dotsWrap.querySelectorAll('.fc-dot')].forEach((d, i) => d.classList.toggle('active', i === idx));
      }

      prevBtn.addEventListener('click', () => scrollToIndex(currentIndex() - 1));
      nextBtn.addEventListener('click', () => scrollToIndex(currentIndex() + 1));
      viewport.addEventListener('scroll', () => window.requestAnimationFrame(updateActiveDot));

      (async () => {
        await loadFromJson();
        render();
        if (typeof renderSelectedFilaments === 'function') renderSelectedFilaments();
      })();
    })();
  </script>

  <!-- Filament image modal -->
  <div class="img-modal" id="imgModal" role="dialog" aria-modal="true" aria-label="РџСЂРѕСЃРјРѕС‚СЂ РёР·РѕР±СЂР°Р¶РµРЅРёСЏ С„РёР»Р°РјРµРЅС‚Р°">
    <div class="img-modal__panel" role="document">
      <div class="img-modal__bar">
        <div class="img-modal__title" id="imgModalTitle">РР·РѕР±СЂР°Р¶РµРЅРёРµ</div>
        <button class="img-modal__close" id="imgModalClose" type="button" aria-label="Р—Р°РєСЂС‹С‚СЊ">вњ•</button>
      </div>
      <img class="img-modal__img" id="imgModalImg" alt="" />
    </div>
  </div>

</body>
</html>
